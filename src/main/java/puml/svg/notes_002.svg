<?xml version="1.0" encoding="UTF-8" standalone="yes"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="361px" style="width:343px;height:361px;" version="1.1" viewBox="0 0 343 361" width="343px"><defs><filter height="300%" id="f1" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FEFECE" filter="url(#f1)" height="48" style="stroke: #A80036; stroke-width: 1.5;" width="125" x="107.5" y="8"/><ellipse cx="122.5" cy="24" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M125.4688,29.6406 Q124.8906,29.9375 124.25,30.0859 Q123.6094,30.2344 122.9063,30.2344 Q120.4063,30.2344 119.0859,28.5859 Q117.7656,26.9375 117.7656,23.8125 Q117.7656,20.6875 119.0859,19.0313 Q120.4063,17.375 122.9063,17.375 Q123.6094,17.375 124.2578,17.5313 Q124.9063,17.6875 125.4688,17.9844 L125.4688,20.7031 Q124.8438,20.125 124.25,19.8516 Q123.6563,19.5781 123.0313,19.5781 Q121.6875,19.5781 121,20.6484 Q120.3125,21.7188 120.3125,23.8125 Q120.3125,25.9063 121,26.9766 Q121.6875,28.0469 123.0313,28.0469 Q123.6563,28.0469 124.25,27.7734 Q124.8438,27.5 125.4688,26.9219 L125.4688,29.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="93" x="136.5" y="28.1543">FullyConnected</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="108.5" x2="231.5" y1="40" y2="40"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="108.5" x2="231.5" y1="48" y2="48"/><polygon fill="#FBFB77" filter="url(#f1)" points="6,116,6,352.9922,334,352.9922,334,126,324,116,6,116" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FBFB77" points="6,116,6,352.9922,334,352.9922,334,126,324,116,174,116,170,56.0246,166,116,6,116" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="324" x2="324" y1="116" y2="126"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="334" x2="324" y1="126" y2="126"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="12" y="133.0669">INDArray</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="123" x="75" y="133.0669">backpropagation</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="198" y="133.0669">( INDArray dLda )</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="20" y="148.1997">INDArray x: = lastInput</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="186" x="20" y="163.3325">INDArray z := lastPreOutput;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="106" x="210" y="163.3325">// z := x W + b</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="20" y="178.4653"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="20" y="193.5981"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="216" x="20" y="193.5981">// backprop activation: a=f(z)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="298" x="20" y="208.731">INDArray dLdz := f.backpropagation(z, dLda );</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="20" y="223.8638"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="20" y="238.9966"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="191" x="20" y="238.9966">// calculate weight update</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="299" x="20" y="254.1294">weightsUpdate := dLdz * x  +  weightsUpdate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="20" y="269.2622"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="20" y="284.395"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="172" x="20" y="284.395">// calculate bias update</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="220" x="20" y="299.5278">biasUpdate := dLdz + biasUpdate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="20" y="314.6606"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="20" y="329.7935"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="264" x="20" y="329.7935">// loss derivative dLdx for next layer</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="20" y="344.9263"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="45" x="20" y="344.9263">return</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="73" y="344.9263">dLdz * weights^T</text></g></svg>