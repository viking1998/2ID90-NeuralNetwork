<?xml version="1.0" encoding="UTF-8" standalone="yes"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="438px" style="width:416px;height:438px;" version="1.1" viewBox="0 0 416 438" width="416px"><defs><filter height="300%" id="f1" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FEFECE" filter="url(#f1)" height="48" style="stroke: #A80036; stroke-width: 1.5;" width="58" x="177.5" y="381"/><ellipse cx="192.5" cy="397" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M195.4688,402.6406 Q194.8906,402.9375 194.25,403.0859 Q193.6094,403.2344 192.9063,403.2344 Q190.4063,403.2344 189.0859,401.5859 Q187.7656,399.9375 187.7656,396.8125 Q187.7656,393.6875 189.0859,392.0313 Q190.4063,390.375 192.9063,390.375 Q193.6094,390.375 194.2578,390.5313 Q194.9063,390.6875 195.4688,390.9844 L195.4688,393.7031 Q194.8438,393.125 194.25,392.8516 Q193.6563,392.5781 193.0313,392.5781 Q191.6875,392.5781 191,393.6484 Q190.3125,394.7188 190.3125,396.8125 Q190.3125,398.9063 191,399.9766 Q191.6875,401.0469 193.0313,401.0469 Q193.6563,401.0469 194.25,400.7734 Q194.8438,400.5 195.4688,399.9219 L195.4688,402.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="26" x="206.5" y="401.1543">SGD</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="178.5" x2="234.5" y1="413" y2="413"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="178.5" x2="234.5" y1="421" y2="421"/><polygon fill="#FBFB77" filter="url(#f1)" points="6,8,6,320.6563,407,320.6563,407,18,397,8,6,8" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FBFB77" points="6,8,6,320.6563,202.5,320.6563,206.5,380.9897,210.5,320.6563,407,320.6563,407,18,397,8,6,8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="397" x2="397" y1="8" y2="18"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="407" x2="397" y1="18" y2="18"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="96" x="12" y="25.0669">trainOnBatch</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="142" x="108" y="25.0669">(TensorPair batch):</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="146" x="28" y="40.1997">batchId := batchId + 1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="16" y="55.3325"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="28" y="70.4653"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="111" x="28" y="70.4653">// forward pass</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="281" x="28" y="85.5981">prediction := model.inference(batch.input);</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="16" y="100.731"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="28" y="115.8638"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="250" x="28" y="115.8638">//compute performance indicators</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="357" x="28" y="130.9966">accuracy := validator.validate(batch.output,prediction)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="356" x="28" y="146.1294">loss := model.outputLayer.calculateLoss(batch.output)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="16" y="161.2622"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="28" y="176.395"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="143" x="28" y="176.395">// back propagation</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="246" x="28" y="191.5278">INDArray back := batch.output.values</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="28" y="206.6606"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="28" y="206.6606">for</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="33" x="53" y="206.6606">layer</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="13" x="90" y="206.6606">in</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="107" y="206.6606">reversed(model.layers)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="241" x="44" y="221.7935">back := layer.backpropagation(back)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="16" y="236.9263"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="28" y="252.0591"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="128" x="28" y="252.0591">// update weights</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="28" y="267.1919"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="28" y="267.1919">for</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="33" x="53" y="267.1919">layer</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="13" x="90" y="267.1919">in</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="107" y="267.1919">model.layers</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="332" x="44" y="282.3247">layer.updateLayer(updater,learningRate,batchSize)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="16" y="297.4575"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="28" y="312.5903"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="45" x="28" y="312.5903">return</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="315" x="77" y="312.5903">BatchResult(batchId,loss,accuracy,learningRate)</text></g></svg>